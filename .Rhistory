geom_segment(aes(x = 4.6, y = beta1[5], xend = 5.4, yend = beta1[5], color = "beta1"), linewidth = 0.55, linetype = "solid") +
geom_segment(aes(x = 4.6, y = beta2[5], xend = 5.4, yend = beta2[5], color = "beta2"), linewidth = 0.55, linetype = "solid") +
geom_segment(aes(x = 4.6, y = beta3[5], xend = 5.4, yend = beta3[5], color = "beta3"), linewidth = 0.55, linetype = "solid") +
geom_segment(aes(x = 5.6, y = beta1[6], xend = 6.4, yend = beta1[6], color = "beta1"), linewidth = 0.55, linetype = "solid") +
geom_segment(aes(x = 5.6, y = beta2[6], xend = 6.4, yend = beta2[6], color = "beta2"), linewidth = 0.55, linetype = "solid") +
geom_segment(aes(x = 5.6, y = beta3[6], xend = 6.4, yend = beta3[6], color = "beta3"), linewidth = 0.55, linetype = "solid") +
geom_segment(aes(x = 6.6, y = beta1[7], xend = 7.4, yend = beta1[7], color = "beta1"), linewidth = 0.55, linetype = "solid") +
geom_segment(aes(x = 6.6, y = beta2[7], xend = 7.4, yend = beta2[7], color = "beta2"), linewidth = 0.55, linetype = "solid") +
geom_segment(aes(x = 6.6, y = beta3[7], xend = 7.4, yend = beta3[7], color = "beta3"), linewidth = 0.55, linetype = "solid") +
geom_segment(aes(x = 7.6, y = beta1[8], xend = 8.4, yend = beta1[8], color = "beta1"), linewidth = 0.55, linetype = "solid") +
geom_segment(aes(x = 7.6, y = beta2[8], xend = 8.4, yend = beta2[8], color = "beta2"), linewidth = 0.55, linetype = "solid") +
geom_segment(aes(x = 7.6, y = beta3[8], xend = 8.4, yend = beta3[8], color = "beta3"), linewidth = 0.55, linetype = "solid") +
scale_color_manual(values = c("red", "orange", "forestgreen"), labels = c("Cluster 1","Cluster 2","Cluster 3")) +
scale_x_discrete(labels = x_labb)  +
scale_y_continuous(breaks = seq(-6,10,2)) +
labs(title = paste("Fixed Effects Comparison", sep = " "),
x = "Parameters",
y = "Estimated Values", fill = lab0, color= lab) +
guides(color = guide_legend(override.aes = list(size = 10)) ) +
theme_minimal() +
theme(
plot.title = element_text(size = 16, face = "bold.italic"),
axis.title = element_text(size = 12),
legend.position = "right",
legend.text = element_text(size = 12),
legend.title = element_text(face = "bold", size = 12),
axis.text.x = element_text(size = 16, face = "bold"),
axis.text.y = element_text(size = 14),
strip.text = element_text(size = 11)
)
# EXTRACT MU'S FROM MODELS
MU1_dep <- data.frame(matrix(0,nrow = 50, ncol = 2 ))
MU2_dep <- data.frame(matrix(0,nrow = 50, ncol = 2 ))
MU3_dep <- data.frame(matrix(0,nrow = 50, ncol = 2))
for(i in 1:50){
ff_dep = c(fit_my_3_cl_dep[[i]]$params$mu[,,1][2], fit_my_3_cl_dep[[i]]$params$mu[,,2][2],
fit_my_3_cl_dep[[i]]$params$mu[,,3][2])
ff_dep = order(ff_dep)
MU1_dep[i,] <- fit_my_3_cl_dep[[i]]$params$mu[,, ff_dep[2] ]
MU2_dep[i,] <- fit_my_3_cl_dep[[i]]$params$mu[,, ff_dep[3] ]
MU3_dep[i,] <- fit_my_3_cl_dep[[i]]$params$mu[,, ff_dep[1] ]
}
N_iter <- 50
mu_total <- cbind(MU1_dep,MU2_dep,MU3_dep)
colnames(mu_total) <- seq(1,6)
x_labb <- c(expression(bold(mu[1]^(x[1]))),expression(bold(mu[1]^(x[2]))),
expression(bold(mu[2]^(x[1]))),expression(bold(mu[2]^(x[2]))),
expression(bold(mu[3]^(x[1]))),expression(bold(mu[3]^(x[2]))))
tt <- melt(mu_total, id.vars = NULL)
gg <-c(rep(1,N_iter*2),rep(2,N_iter*2),rep(3,N_iter*2))
ff <- cbind(tt,gg)
legend_data <- data.frame(
label = c("beta1"),
color = c("dodgerblue")
)
lab <- expression(paste("Real Values ", (bold(mu)[c])))
ggplot(ff, aes(x = variable, y = value, fill = as.factor(gg))) +
geom_boxplot() +
labs(title = "Mean Parameter of Continuous Covariates",
x = "Parameters",
y = "Estimated Values", fill = "Estimated Values \n(across 100 runs)", color= lab) +
geom_segment(aes(x = 0.5, y = 2.05, xend = 1.5, yend = 2.05, color = "beta1"),linetype = "solid", linewidth = 0.5) +
geom_segment(aes(x = 1.5, y = 0.02, xend = 2.5, yend = 0.02, color = "beta1"),linetype = "solid", linewidth = 0.5) +
geom_segment(aes(x = 2.5, y = 5.06, xend = 3.5, yend = 5.06, color = "beta2"),linetype = "solid", linewidth = 0.5) +
geom_segment(aes(x = 3.5, y = 4.84, xend = 4.5, yend = 4.84, color = "beta2"),linetype = "solid", linewidth = 0.5) +
geom_segment(aes(x = 4.5, y = 4.22, xend = 5.5, yend = 4.22, color = "beta3"),linetype = "solid", linewidth = 0.5) +
geom_segment(aes(x = 5.5, y = -4.51, xend = 6.5, yend = -4.51, color = "beta3"),linetype = "solid", linewidth = 0.5)+
scale_x_discrete(labels = x_labb) +
scale_color_manual(values = c("red", "orange", "forestgreen"), labels = c("Cluster 1","Cluster 2","Cluster 3")) +
scale_fill_manual(values = alpha(c("red", "orange", "forestgreen"),0.6), labels = c("Cluster 1","Cluster 2","Cluster 3") ) +
theme_minimal() +
theme(
plot.title = element_text(size = 14, face = "bold.italic"),
axis.title = element_text(size = 14),
legend.position = "right",
legend.text = element_text(size = 10),
legend.key.width = unit(3, "lines"),
legend.title = element_text(face = "bold.italic", size = 10),
axis.text.x = element_text(size = 14, face = "bold.italic", color = c("red","red", "orange", "orange", "forestgreen", "forestgreen")),
axis.text.y = element_text(size = 12),
strip.text = element_text(size = 11)
)
# EXTRACT MU'S FROM MODELS
MU1_dep <- data.frame(matrix(0,nrow = 50, ncol = 2 ))
MU2_dep <- data.frame(matrix(0,nrow = 50, ncol = 2 ))
MU3_dep <- data.frame(matrix(0,nrow = 50, ncol = 2))
for(i in 1:50){
ff_dep = c(fit_my_3_cl_dep[[i]]$params$mu[,,1][2], fit_my_3_cl_dep[[i]]$params$mu[,,2][2],
fit_my_3_cl_dep[[i]]$params$mu[,,3][2])
ff_dep = order(ff_dep)
MU1_dep[i,] <- fit_my_3_cl_dep[[i]]$params$mu[,, ff_dep[2] ]
MU2_dep[i,] <- fit_my_3_cl_dep[[i]]$params$mu[,, ff_dep[3] ]
MU3_dep[i,] <- fit_my_3_cl_dep[[i]]$params$mu[,, ff_dep[1] ]
}
N_iter <- 50
mu_total <- cbind(MU1_dep,MU2_dep,MU3_dep)
colnames(mu_total) <- seq(1,6)
x_labb <- c(expression(bold(mu[1]^(x[1]))),expression(bold(mu[1]^(x[2]))),
expression(bold(mu[2]^(x[1]))),expression(bold(mu[2]^(x[2]))),
expression(bold(mu[3]^(x[1]))),expression(bold(mu[3]^(x[2]))))
tt <- melt(mu_total, id.vars = NULL)
gg <-c(rep(1,N_iter*2),rep(2,N_iter*2),rep(3,N_iter*2))
ff <- cbind(tt,gg)
legend_data <- data.frame(
label = c("beta1"),
color = c("dodgerblue")
)
lab <- expression(paste("Real Values ", (bold(mu)[c])))
ggplot(ff, aes(x = variable, y = value, fill = as.factor(gg))) +
geom_boxplot() +
labs(title = "Mean Parameter of Continuous Covariates",
x = "Parameters",
y = "Estimated Values", fill = "Estimated Values \n(across 100 runs)", color= lab) +
geom_segment(aes(x = 0.5, y = 2.05, xend = 1.5, yend = 2.05, color = "beta1"),linetype = "solid", linewidth = 0.5) +
geom_segment(aes(x = 1.5, y = 0.02, xend = 2.5, yend = 0.02, color = "beta1"),linetype = "solid", linewidth = 0.5) +
geom_segment(aes(x = 2.5, y = 5.06, xend = 3.5, yend = 5.06, color = "beta2"),linetype = "solid", linewidth = 0.5) +
geom_segment(aes(x = 3.5, y = 4.84, xend = 4.5, yend = 4.84, color = "beta2"),linetype = "solid", linewidth = 0.5) +
geom_segment(aes(x = 4.5, y = 4.22, xend = 5.5, yend = 4.22, color = "beta3"),linetype = "solid", linewidth = 0.5) +
geom_segment(aes(x = 5.5, y = -4.51, xend = 6.5, yend = -4.51, color = "beta3"),linetype = "solid", linewidth = 0.5)+
scale_x_discrete(labels = x_labb) +
scale_color_manual(values = c("red", "orange", "forestgreen"), labels = c("Cluster 1","Cluster 2","Cluster 3")) +
scale_fill_manual(values = alpha(c("red", "orange", "forestgreen"),0.6), labels = c("Cluster 1","Cluster 2","Cluster 3") ) +
theme_minimal() +
theme(
plot.title = element_text(size = 14, face = "bold.italic"),
axis.title = element_text(size = 14),
legend.position = "right",
legend.text = element_text(size = 10),
legend.key.width = unit(3, "lines"),
legend.title = element_text(face = "bold.italic", size = 10),
axis.text.x = element_text(size = 14, face = "bold.italic", color = c("red","red", "orange", "orange", "forestgreen", "forestgreen")),
axis.text.y = element_text(size = 12),
strip.text = element_text(size = 11)
)
lab <- expression(paste(bold("Real Values"), (bold(mu)[c])))
ggplot(ff, aes(x = variable, y = value, fill = as.factor(gg))) +
geom_boxplot() +
labs(title = "Mean Parameter of Continuous Covariates",
x = "Parameters",
y = "Estimated Values", fill = "Estimated Values \n(across 100 runs)", color= lab) +
geom_segment(aes(x = 0.5, y = 2.05, xend = 1.5, yend = 2.05, color = "beta1"),linetype = "solid", linewidth = 0.5) +
geom_segment(aes(x = 1.5, y = 0.02, xend = 2.5, yend = 0.02, color = "beta1"),linetype = "solid", linewidth = 0.5) +
geom_segment(aes(x = 2.5, y = 5.06, xend = 3.5, yend = 5.06, color = "beta2"),linetype = "solid", linewidth = 0.5) +
geom_segment(aes(x = 3.5, y = 4.84, xend = 4.5, yend = 4.84, color = "beta2"),linetype = "solid", linewidth = 0.5) +
geom_segment(aes(x = 4.5, y = 4.22, xend = 5.5, yend = 4.22, color = "beta3"),linetype = "solid", linewidth = 0.5) +
geom_segment(aes(x = 5.5, y = -4.51, xend = 6.5, yend = -4.51, color = "beta3"),linetype = "solid", linewidth = 0.5)+
scale_x_discrete(labels = x_labb) +
scale_color_manual(values = c("red", "orange", "forestgreen"), labels = c("Cluster 1","Cluster 2","Cluster 3")) +
scale_fill_manual(values = alpha(c("red", "orange", "forestgreen"),0.6), labels = c("Cluster 1","Cluster 2","Cluster 3") ) +
theme_minimal() +
theme(
plot.title = element_text(size = 14, face = "bold.italic"),
axis.title = element_text(size = 14),
legend.position = "right",
legend.text = element_text(size = 10),
legend.key.width = unit(3, "lines"),
legend.title = element_text(face = "bold.italic", size = 10),
axis.text.x = element_text(size = 14, face = "bold.italic", color = c("red","red", "orange", "orange", "forestgreen", "forestgreen")),
axis.text.y = element_text(size = 12),
strip.text = element_text(size = 11)
)
ggplot(ff, aes(x = variable, y = value, fill = as.factor(gg))) +
geom_boxplot() +
labs(title = "Mean Parameter of Continuous Covariates",
x = "Parameters",
y = "Estimated Values", fill = "Estimated Values \n(across 100 runs)", color= lab) +
geom_segment(aes(x = 0.5, y = 2.05, xend = 1.5, yend = 2.05, color = "beta1"),linetype = "solid", linewidth = 0.5) +
geom_segment(aes(x = 1.5, y = 0.02, xend = 2.5, yend = 0.02, color = "beta1"),linetype = "solid", linewidth = 0.5) +
geom_segment(aes(x = 2.5, y = 5.06, xend = 3.5, yend = 5.06, color = "beta2"),linetype = "solid", linewidth = 0.5) +
geom_segment(aes(x = 3.5, y = 4.84, xend = 4.5, yend = 4.84, color = "beta2"),linetype = "solid", linewidth = 0.5) +
geom_segment(aes(x = 4.5, y = 4.22, xend = 5.5, yend = 4.22, color = "beta3"),linetype = "solid", linewidth = 0.5) +
geom_segment(aes(x = 5.5, y = -4.51, xend = 6.5, yend = -4.51, color = "beta3"),linetype = "solid", linewidth = 0.5)+
scale_x_discrete(labels = x_labb) +
scale_color_manual(values = c("red", "orange", "forestgreen"), labels = c("Cluster 1","Cluster 2","Cluster 3")) +
scale_fill_manual(values = alpha(c("red", "orange", "forestgreen"),0.6), labels = c("Cluster 1","Cluster 2","Cluster 3") ) +
theme_minimal() +
theme(
plot.title = element_text(size = 14, face = "bold.italic"),
axis.title = element_text(size = 14),
legend.position = "right",
legend.text = element_text(size = 10),
legend.key.width = unit(3, "lines"),
legend.title = element_text(face = "bold", size = 10),
axis.text.x = element_text(size = 14, face = "bold.italic", color = c("red","red", "orange", "orange", "forestgreen", "forestgreen")),
axis.text.y = element_text(size = 12),
strip.text = element_text(size = 11)
)
# EXTRACT LAMBDA'S FROM MODELS
COV1_dep <- data.frame(matrix(0,nrow = 50, ncol = 3 ))
COV2_dep <- data.frame(matrix(0,nrow = 50, ncol = 3 ))
COV3_dep <- data.frame(matrix(0,nrow = 50, ncol = 3))
for(i in 1:50){
ff_dep = c(fit_my_3_cl_dep[[i]]$params$mu[,,1][2], fit_my_3_cl_dep[[i]]$params$mu[,,2][2],
fit_my_3_cl_dep[[i]]$params$mu[,,3][2])
ff_dep = order(ff_dep)
COV1_dep[i,] <- c(fit_my_3_cl_dep[[i]]$params$sigma[,, ff_dep[2] ] )[-3]
COV2_dep[i,] <- c(fit_my_3_cl_dep[[i]]$params$sigma[,, ff_dep[3] ])[-3]
COV3_dep[i,] <- c(fit_my_3_cl_dep[[i]]$params$sigma[,, ff_dep[1] ])[-3]
}
legend_data <- data.frame(
label = c("beta1"),
color = c("dodgerblue")
)
COV_total <- cbind(COV1_dep,COV2_dep,COV3_dep)
colnames(COV_total) <- seq(1,9)
x_labb <- c(expression(bold(Sigma[11])),expression(bold(Sigma[12])),
expression(bold(Sigma[22])),expression(bold(Sigma[11])),
expression(bold(Sigma[12])),expression(bold(Sigma[22])),
expression(bold(Sigma[11])),
expression(bold(Sigma[12])),expression(bold(Sigma[22])) )
tt <- melt(COV_total, id.vars = NULL)
gg <-c(rep(1,N_iter*3),rep(2,N_iter*3),rep(3,N_iter*3))
ff <- cbind(tt,gg)
ggplot(ff, aes(x = variable, y = value, fill = as.factor(gg))) +
geom_boxplot() +
labs(title = paste("Covariance Matrices Parameters of Continuous Covariates", sep = " "),
x = "Parameters",
y = "Estimated Values", fill = "Estimated Values \n(across 100 runs)", color= "Real Values") +
geom_segment(aes(x = 0.5, y = 0.7 , xend = 1.8, yend = 0.7 , color = "beta1"),linetype = "solid", linewidth = 0.5) +
geom_segment(aes(x = 1.2, y = 0.5, xend = 2.8, yend = 0.5, color = "beta1"),linetype = "solid", linewidth = 0.5) +
geom_segment(aes(x = 2.2, y = 3, xend = 3.8, yend = 3, color = "beta1"),linetype = "solid", linewidth = 0.5) +
geom_segment(aes(x = 3.2, y = 2, xend = 4.8, yend = 2, color = "beta2"),linetype = "solid", linewidth = 0.5) +
geom_segment(aes(x = 4.2, y = -1, xend = 5.8, yend = -1, color = "beta2"),linetype = "solid", linewidth = 0.5) +
geom_segment(aes(x = 5.2, y = 3, xend = 6.8, yend = 3, color = "beta2"),linetype = "solid", size = 0.5)+
geom_segment(aes(x = 6.2, y = 3, xend = 7.8, yend = 3, color = "beta3"),linetype = "solid", linewidth = 0.5) +
geom_segment(aes(x = 7.2, y = 1 , xend = 8.8, yend = 1 , color = "beta3"),linetype = "solid", linewidth = 0.5) +
geom_segment(aes(x = 8.2, y = 2, xend = 9.7, yend = 2, color = "beta3"),linetype = "solid", linewidth = 0.5) +
scale_color_manual(values = c("red", "orange", "forestgreen"), labels = c("Cluster 1","Cluster 2","Cluster 3") ) +
scale_x_discrete(labels = x_labb) +
scale_fill_manual(values = alpha(c("red", "orange", "forestgreen"),0.6), labels = c("Cluster 1","Cluster 2","Cluster 3") ) +
theme_minimal() +
theme(
plot.title = element_text(size = 14, face = "bold.italic"),
axis.title = element_text(size = 14),
legend.position = "right",
legend.text = element_text(size = 10),
legend.key.width = unit(3, "lines"),
legend.title = element_text(face = "bold.italic", size = 10),
axis.text.x = element_text(size = 14, face = "bold.italic", color = c("red","red","red", "orange", "orange", "orange", "forestgreen", "forestgreen", "forestgreen")),
axis.text.y = element_text(size = 12),
strip.text = element_text(size = 11)
)
x_labb <- c(expression(bold(Sigma[1]^[11])),expression(bold(Sigma[1])),
# EXTRACT LAMBDA'S FROM MODELS
COV1_dep <- data.frame(matrix(0,nrow = 50, ncol = 3 ))
COV2_dep <- data.frame(matrix(0,nrow = 50, ncol = 3 ))
COV3_dep <- data.frame(matrix(0,nrow = 50, ncol = 3))
for(i in 1:50){
ff_dep = c(fit_my_3_cl_dep[[i]]$params$mu[,,1][2], fit_my_3_cl_dep[[i]]$params$mu[,,2][2],
fit_my_3_cl_dep[[i]]$params$mu[,,3][2])
ff_dep = order(ff_dep)
COV1_dep[i,] <- c(fit_my_3_cl_dep[[i]]$params$sigma[,, ff_dep[2] ] )[-3]
COV2_dep[i,] <- c(fit_my_3_cl_dep[[i]]$params$sigma[,, ff_dep[3] ])[-3]
COV3_dep[i,] <- c(fit_my_3_cl_dep[[i]]$params$sigma[,, ff_dep[1] ])[-3]
}
legend_data <- data.frame(
label = c("beta1"),
color = c("dodgerblue")
)
COV_total <- cbind(COV1_dep,COV2_dep,COV3_dep)
colnames(COV_total) <- seq(1,9)
x_labb <- c(expression(bold(Sigma[1]^11)),expression(bold(Sigma[1])),
expression(bold(Sigma[2])),expression(bold(Sigma[2])),
expression(bold(Sigma[2])),expression(bold(Sigma[2])),
expression(bold(Sigma[3])),
expression(bold(Sigma[3])),expression(bold(Sigma[3])) )
tt <- melt(COV_total, id.vars = NULL)
gg <-c(rep(1,N_iter*3),rep(2,N_iter*3),rep(3,N_iter*3))
ff <- cbind(tt,gg)
ggplot(ff, aes(x = variable, y = value, fill = as.factor(gg))) +
geom_boxplot() +
labs(title = paste("Covariance Matrices Parameters of Continuous Covariates", sep = " "),
x = "Parameters",
y = "Estimated Values", fill = "Estimated Values \n(across 100 runs)", color= "Real Values") +
geom_segment(aes(x = 0.5, y = 0.7 , xend = 1.8, yend = 0.7 , color = "beta1"),linetype = "solid", linewidth = 0.5) +
geom_segment(aes(x = 1.2, y = 0.5, xend = 2.8, yend = 0.5, color = "beta1"),linetype = "solid", linewidth = 0.5) +
geom_segment(aes(x = 2.2, y = 3, xend = 3.8, yend = 3, color = "beta1"),linetype = "solid", linewidth = 0.5) +
geom_segment(aes(x = 3.2, y = 2, xend = 4.8, yend = 2, color = "beta2"),linetype = "solid", linewidth = 0.5) +
geom_segment(aes(x = 4.2, y = -1, xend = 5.8, yend = -1, color = "beta2"),linetype = "solid", linewidth = 0.5) +
geom_segment(aes(x = 5.2, y = 3, xend = 6.8, yend = 3, color = "beta2"),linetype = "solid", size = 0.5)+
geom_segment(aes(x = 6.2, y = 3, xend = 7.8, yend = 3, color = "beta3"),linetype = "solid", linewidth = 0.5) +
geom_segment(aes(x = 7.2, y = 1 , xend = 8.8, yend = 1 , color = "beta3"),linetype = "solid", linewidth = 0.5) +
geom_segment(aes(x = 8.2, y = 2, xend = 9.7, yend = 2, color = "beta3"),linetype = "solid", linewidth = 0.5) +
scale_color_manual(values = c("red", "orange", "forestgreen"), labels = c("Cluster 1","Cluster 2","Cluster 3") ) +
scale_x_discrete(labels = x_labb) +
scale_fill_manual(values = alpha(c("red", "orange", "forestgreen"),0.6), labels = c("Cluster 1","Cluster 2","Cluster 3") ) +
theme_minimal() +
theme(
plot.title = element_text(size = 14, face = "bold.italic"),
axis.title = element_text(size = 14),
legend.position = "right",
legend.text = element_text(size = 10),
legend.key.width = unit(3, "lines"),
legend.title = element_text(face = "bold.italic", size = 10),
axis.text.x = element_text(size = 14, face = "bold.italic", color = c("red","red","red", "orange", "orange", "orange", "forestgreen", "forestgreen", "forestgreen")),
axis.text.y = element_text(size = 12),
strip.text = element_text(size = 11)
)
# EXTRACT LAMBDA'S FROM MODELS
COV1_dep <- data.frame(matrix(0,nrow = 50, ncol = 3 ))
COV2_dep <- data.frame(matrix(0,nrow = 50, ncol = 3 ))
COV3_dep <- data.frame(matrix(0,nrow = 50, ncol = 3))
for(i in 1:50){
ff_dep = c(fit_my_3_cl_dep[[i]]$params$mu[,,1][2], fit_my_3_cl_dep[[i]]$params$mu[,,2][2],
fit_my_3_cl_dep[[i]]$params$mu[,,3][2])
ff_dep = order(ff_dep)
COV1_dep[i,] <- c(fit_my_3_cl_dep[[i]]$params$sigma[,, ff_dep[2] ] )[-3]
COV2_dep[i,] <- c(fit_my_3_cl_dep[[i]]$params$sigma[,, ff_dep[3] ])[-3]
COV3_dep[i,] <- c(fit_my_3_cl_dep[[i]]$params$sigma[,, ff_dep[1] ])[-3]
}
legend_data <- data.frame(
label = c("beta1"),
color = c("dodgerblue")
)
COV_total <- cbind(COV1_dep,COV2_dep,COV3_dep)
colnames(COV_total) <- seq(1,9)
x_labb <- c(expression(bold(Sigma[1]^(11))),expression(bold(Sigma[1]^(12))),
expression(bold(Sigma[2]^(22))),expression(bold(Sigma[2]^(11))),
expression(bold(Sigma[2]^(12))),expression(bold(Sigma[2]^(22))),
expression(bold(Sigma[3]^(11))),
expression(bold(Sigma[3]^(12))),expression(bold(Sigma[3]^(22))) )
tt <- melt(COV_total, id.vars = NULL)
gg <-c(rep(1,N_iter*3),rep(2,N_iter*3),rep(3,N_iter*3))
ff <- cbind(tt,gg)
lab <- expression(paste(bold("Real Values"), (bold(Sigma)[c])))
ggplot(ff, aes(x = variable, y = value, fill = as.factor(gg))) +
geom_boxplot() +
labs(title = paste("Covariance Matrices Parameters of Continuous Covariates", sep = " "),
x = "Parameters",
y = "Estimated Values", fill = "Estimated Values \n(across 100 runs)", color= lab) +
geom_segment(aes(x = 0.5, y = 0.7 , xend = 1.8, yend = 0.7 , color = "beta1"),linetype = "solid", linewidth = 0.5) +
geom_segment(aes(x = 1.2, y = 0.5, xend = 2.8, yend = 0.5, color = "beta1"),linetype = "solid", linewidth = 0.5) +
geom_segment(aes(x = 2.2, y = 3, xend = 3.8, yend = 3, color = "beta1"),linetype = "solid", linewidth = 0.5) +
geom_segment(aes(x = 3.2, y = 2, xend = 4.8, yend = 2, color = "beta2"),linetype = "solid", linewidth = 0.5) +
geom_segment(aes(x = 4.2, y = -1, xend = 5.8, yend = -1, color = "beta2"),linetype = "solid", linewidth = 0.5) +
geom_segment(aes(x = 5.2, y = 3, xend = 6.8, yend = 3, color = "beta2"),linetype = "solid", size = 0.5)+
geom_segment(aes(x = 6.2, y = 3, xend = 7.8, yend = 3, color = "beta3"),linetype = "solid", linewidth = 0.5) +
geom_segment(aes(x = 7.2, y = 1 , xend = 8.8, yend = 1 , color = "beta3"),linetype = "solid", linewidth = 0.5) +
geom_segment(aes(x = 8.2, y = 2, xend = 9.7, yend = 2, color = "beta3"),linetype = "solid", linewidth = 0.5) +
scale_color_manual(values = c("red", "orange", "forestgreen"), labels = c("Cluster 1","Cluster 2","Cluster 3") ) +
scale_x_discrete(labels = x_labb) +
scale_fill_manual(values = alpha(c("red", "orange", "forestgreen"),0.6), labels = c("Cluster 1","Cluster 2","Cluster 3") ) +
theme_minimal() +
theme(
plot.title = element_text(size = 14, face = "bold.italic"),
axis.title = element_text(size = 14),
legend.position = "right",
legend.text = element_text(size = 10),
legend.key.width = unit(3, "lines"),
legend.title = element_text(face = "bold.italic", size = 10),
axis.text.x = element_text(size = 14, face = "bold.italic", color = c("red","red","red", "orange", "orange", "orange", "forestgreen", "forestgreen", "forestgreen")),
axis.text.y = element_text(size = 12),
strip.text = element_text(size = 11)
)
# Plotting code with modifications for the legend
lab <- expression(paste(bold("Real Values "), (bold(beta[c]) )))
x_labb <- c(expression(beta[c1]),expression(beta[c2]),expression(beta[c3]),expression(beta[c4]),expression(beta[c5]),
expression(beta[c6]),expression(beta[c7]),expression(beta[c8]))
tt1 <- melt(beta1_dep, id.vars = NULL)
tt1$labb <- rep("ML-CWMd (Cluster 1)",dim(tt1)[1])
tt2 <- melt(beta2_dep, id.vars = NULL)
tt2$labb <- rep("ML-CWMd (Cluster 2)",dim(tt2)[1])
tt3 <- melt(beta3_dep, id.vars = NULL)
tt3$labb <- rep("ML-CWMd (Cluster 3)",dim(tt3)[1])
tt4 <- melt(beta_glm, id.vars = NULL)
tt4$labb <- rep("GLM",dim(tt4)[1])
tt5 <- melt(beta_glmer, id.vars = NULL)
tt5$labb <- rep("GLMER",dim(tt5)[1])
tt_tot <- rbind(tt1,tt2,tt3,tt4, tt5)
legend_data <- data.frame(
label = c("beta1", "beta2", "beta3"),
color = c("red", "orange", "forestgreen")
)
# Plotting code with modifications for the legend
lab <- expression(paste(bold("Real Values "), (bold(beta[c]) )))
#lab0 <- expression(bold(paste("Estimated Values \nacross 100 runs",(bold(beta[c])))))
lab0 <- bold("Estimated Values \nacross 100 runs")
x_labb <- c(expression(beta[c1]),expression(beta[c2]),expression(beta[c3]),expression(beta[c4]),expression(beta[c5]),
expression(beta[c6]),expression(beta[c7]),expression(beta[c8]))
tt1 <- melt(beta1_dep, id.vars = NULL)
tt1$labb <- rep("ML-CWMd (Cluster 1)",dim(tt1)[1])
tt2 <- melt(beta2_dep, id.vars = NULL)
tt2$labb <- rep("ML-CWMd (Cluster 2)",dim(tt2)[1])
tt3 <- melt(beta3_dep, id.vars = NULL)
tt3$labb <- rep("ML-CWMd (Cluster 3)",dim(tt3)[1])
tt4 <- melt(beta_glm, id.vars = NULL)
tt4$labb <- rep("GLM",dim(tt4)[1])
tt5 <- melt(beta_glmer, id.vars = NULL)
tt5$labb <- rep("GLMER",dim(tt5)[1])
tt_tot <- rbind(tt1,tt2,tt3,tt4, tt5)
legend_data <- data.frame(
label = c("beta1", "beta2", "beta3"),
color = c("red", "orange", "forestgreen")
)
# Plotting code with modifications for the legend
lab <- expression(paste(bold("Real Values "), (bold(beta[c]) )))
#lab0 <- expression(bold(paste("Estimated Values \nacross 100 runs",(bold(beta[c])))))
lab0 <- expression(bold("Estimated Values \nacross 100 runs"))
ggplot(tt_tot) +
geom_boxplot(aes(x=variable, y=value, fill = labb)) +
scale_fill_manual(values = alpha(c("blue", "purple","red", "orange", "forestgreen"), 0.4)) +
geom_segment(aes(x = 0.6, y = beta1[1], xend = 1.4, yend = beta1[1], color = "beta1"), linewidth = 0.55, linetype = "solid") +
geom_segment(aes(x = 0.6, y = beta2[1], xend = 1.4, yend = beta2[1], color = "beta2"), linewidth = 0.55, linetype = "solid") +
geom_segment(aes(x = 0.6, y = beta3[1], xend = 1.4, yend = beta3[1], color = "beta3"), linewidth = 0.55, linetype = "solid") +
geom_segment(aes(x = 1.6, y = beta1[2], xend = 2.4, yend = beta1[2], color = "beta1"), linewidth = 0.55, linetype = "solid") +
geom_segment(aes(x = 1.6, y = beta2[2], xend = 2.4, yend = beta2[2], color = "beta2"), linewidth = 0.55, linetype = "solid") +
geom_segment(aes(x = 1.6, y = beta3[2], xend = 2.4, yend = beta3[2], color = "beta3"), linewidth = 0.55, linetype = "solid") +
geom_segment(aes(x = 2.6, y = beta1[3], xend = 3.4, yend = beta1[3], color = "beta1"), linewidth = 0.55, linetype = "solid") +
geom_segment(aes(x = 2.6, y = beta2[3], xend = 3.4, yend = beta2[3], color = "beta2"), linewidth = 0.55, linetype = "solid") +
geom_segment(aes(x = 2.6, y = beta3[3], xend = 3.4, yend = beta3[3], color = "beta3"), linewidth = 0.55, linetype = "solid") +
geom_segment(aes(x = 3.6, y = beta1[4], xend = 4.4, yend = beta1[4], color = "beta1"), linewidth = 0.55, linetype = "solid") +
geom_segment(aes(x = 3.6, y = beta2[4], xend = 4.4, yend = beta2[4], color = "beta2"), linewidth = 0.55, linetype = "solid") +
geom_segment(aes(x = 3.6, y = beta3[4], xend = 4.4, yend = beta3[4], color = "beta3"), linewidth = 0.55, linetype = "solid") +
geom_segment(aes(x = 4.6, y = beta1[5], xend = 5.4, yend = beta1[5], color = "beta1"), linewidth = 0.55, linetype = "solid") +
geom_segment(aes(x = 4.6, y = beta2[5], xend = 5.4, yend = beta2[5], color = "beta2"), linewidth = 0.55, linetype = "solid") +
geom_segment(aes(x = 4.6, y = beta3[5], xend = 5.4, yend = beta3[5], color = "beta3"), linewidth = 0.55, linetype = "solid") +
geom_segment(aes(x = 5.6, y = beta1[6], xend = 6.4, yend = beta1[6], color = "beta1"), linewidth = 0.55, linetype = "solid") +
geom_segment(aes(x = 5.6, y = beta2[6], xend = 6.4, yend = beta2[6], color = "beta2"), linewidth = 0.55, linetype = "solid") +
geom_segment(aes(x = 5.6, y = beta3[6], xend = 6.4, yend = beta3[6], color = "beta3"), linewidth = 0.55, linetype = "solid") +
geom_segment(aes(x = 6.6, y = beta1[7], xend = 7.4, yend = beta1[7], color = "beta1"), linewidth = 0.55, linetype = "solid") +
geom_segment(aes(x = 6.6, y = beta2[7], xend = 7.4, yend = beta2[7], color = "beta2"), linewidth = 0.55, linetype = "solid") +
geom_segment(aes(x = 6.6, y = beta3[7], xend = 7.4, yend = beta3[7], color = "beta3"), linewidth = 0.55, linetype = "solid") +
geom_segment(aes(x = 7.6, y = beta1[8], xend = 8.4, yend = beta1[8], color = "beta1"), linewidth = 0.55, linetype = "solid") +
geom_segment(aes(x = 7.6, y = beta2[8], xend = 8.4, yend = beta2[8], color = "beta2"), linewidth = 0.55, linetype = "solid") +
geom_segment(aes(x = 7.6, y = beta3[8], xend = 8.4, yend = beta3[8], color = "beta3"), linewidth = 0.55, linetype = "solid") +
scale_color_manual(values = c("red", "orange", "forestgreen"), labels = c("Cluster 1","Cluster 2","Cluster 3")) +
scale_x_discrete(labels = x_labb)  +
scale_y_continuous(breaks = seq(-6,10,2)) +
labs(title = paste("Fixed Effects Comparison", sep = " "),
x = "Parameters",
y = "Estimated Values", fill = lab0, color= lab) +
guides(color = guide_legend(override.aes = list(size = 10)) ) +
theme_minimal() +
theme(
plot.title = element_text(size = 16, face = "bold.italic"),
axis.title = element_text(size = 12),
legend.position = "right",
legend.text = element_text(size = 12),
legend.title = element_text(face = "bold", size = 12),
axis.text.x = element_text(size = 16, face = "bold"),
axis.text.y = element_text(size = 14),
strip.text = element_text(size = 11)
)
# Plotting code with modifications for the legend
lab <- expression(paste(bold("Real Values "), (bold(beta)[c] )))
ggplot(tt_tot) +
geom_boxplot(aes(x=variable, y=value, fill = labb)) +
scale_fill_manual(values = alpha(c("blue", "purple","red", "orange", "forestgreen"), 0.4)) +
geom_segment(aes(x = 0.6, y = beta1[1], xend = 1.4, yend = beta1[1], color = "beta1"), linewidth = 0.55, linetype = "solid") +
geom_segment(aes(x = 0.6, y = beta2[1], xend = 1.4, yend = beta2[1], color = "beta2"), linewidth = 0.55, linetype = "solid") +
geom_segment(aes(x = 0.6, y = beta3[1], xend = 1.4, yend = beta3[1], color = "beta3"), linewidth = 0.55, linetype = "solid") +
geom_segment(aes(x = 1.6, y = beta1[2], xend = 2.4, yend = beta1[2], color = "beta1"), linewidth = 0.55, linetype = "solid") +
geom_segment(aes(x = 1.6, y = beta2[2], xend = 2.4, yend = beta2[2], color = "beta2"), linewidth = 0.55, linetype = "solid") +
geom_segment(aes(x = 1.6, y = beta3[2], xend = 2.4, yend = beta3[2], color = "beta3"), linewidth = 0.55, linetype = "solid") +
geom_segment(aes(x = 2.6, y = beta1[3], xend = 3.4, yend = beta1[3], color = "beta1"), linewidth = 0.55, linetype = "solid") +
geom_segment(aes(x = 2.6, y = beta2[3], xend = 3.4, yend = beta2[3], color = "beta2"), linewidth = 0.55, linetype = "solid") +
geom_segment(aes(x = 2.6, y = beta3[3], xend = 3.4, yend = beta3[3], color = "beta3"), linewidth = 0.55, linetype = "solid") +
geom_segment(aes(x = 3.6, y = beta1[4], xend = 4.4, yend = beta1[4], color = "beta1"), linewidth = 0.55, linetype = "solid") +
geom_segment(aes(x = 3.6, y = beta2[4], xend = 4.4, yend = beta2[4], color = "beta2"), linewidth = 0.55, linetype = "solid") +
geom_segment(aes(x = 3.6, y = beta3[4], xend = 4.4, yend = beta3[4], color = "beta3"), linewidth = 0.55, linetype = "solid") +
geom_segment(aes(x = 4.6, y = beta1[5], xend = 5.4, yend = beta1[5], color = "beta1"), linewidth = 0.55, linetype = "solid") +
geom_segment(aes(x = 4.6, y = beta2[5], xend = 5.4, yend = beta2[5], color = "beta2"), linewidth = 0.55, linetype = "solid") +
geom_segment(aes(x = 4.6, y = beta3[5], xend = 5.4, yend = beta3[5], color = "beta3"), linewidth = 0.55, linetype = "solid") +
geom_segment(aes(x = 5.6, y = beta1[6], xend = 6.4, yend = beta1[6], color = "beta1"), linewidth = 0.55, linetype = "solid") +
geom_segment(aes(x = 5.6, y = beta2[6], xend = 6.4, yend = beta2[6], color = "beta2"), linewidth = 0.55, linetype = "solid") +
geom_segment(aes(x = 5.6, y = beta3[6], xend = 6.4, yend = beta3[6], color = "beta3"), linewidth = 0.55, linetype = "solid") +
geom_segment(aes(x = 6.6, y = beta1[7], xend = 7.4, yend = beta1[7], color = "beta1"), linewidth = 0.55, linetype = "solid") +
geom_segment(aes(x = 6.6, y = beta2[7], xend = 7.4, yend = beta2[7], color = "beta2"), linewidth = 0.55, linetype = "solid") +
geom_segment(aes(x = 6.6, y = beta3[7], xend = 7.4, yend = beta3[7], color = "beta3"), linewidth = 0.55, linetype = "solid") +
geom_segment(aes(x = 7.6, y = beta1[8], xend = 8.4, yend = beta1[8], color = "beta1"), linewidth = 0.55, linetype = "solid") +
geom_segment(aes(x = 7.6, y = beta2[8], xend = 8.4, yend = beta2[8], color = "beta2"), linewidth = 0.55, linetype = "solid") +
geom_segment(aes(x = 7.6, y = beta3[8], xend = 8.4, yend = beta3[8], color = "beta3"), linewidth = 0.55, linetype = "solid") +
scale_color_manual(values = c("red", "orange", "forestgreen"), labels = c("Cluster 1","Cluster 2","Cluster 3")) +
scale_x_discrete(labels = x_labb)  +
scale_y_continuous(breaks = seq(-6,10,2)) +
labs(title = paste("Fixed Effects Comparison", sep = " "),
x = "Parameters",
y = "Estimated Values", fill = lab0, color= lab) +
guides(color = guide_legend(override.aes = list(size = 10)) ) +
theme_minimal() +
theme(
plot.title = element_text(size = 16, face = "bold.italic"),
axis.title = element_text(size = 12),
legend.position = "right",
legend.text = element_text(size = 12),
legend.title = element_text(face = "bold", size = 12),
axis.text.x = element_text(size = 16, face = "bold"),
axis.text.y = element_text(size = 14),
strip.text = element_text(size = 11)
)
setwd("C:/Users/mucci/Desktop/Prova_ML-CWMd")
table_BIC <- function(BIC_vector){
border_string <- "border-bottom: 2px solid;border-top: 2px solid;border-left: 2px solid;border-right: 2px solid;"
ff = as.matrix(cbind(Clusters = c("C = 2","C = 3","C = 4"), BIC = round(BIC_vector,2)))
cn <- colnames(ff)
idx_best <- which.min(BIC_vector)
colnames(ff) <- NULL
ff %>% kbl(align = c("c", "c")) %>%
kable_styling(font_size = 20)  %>%
row_spec(idx_best, color = "black",
background = "rgba(0, 255, 0, 0.6)", bold = F) %>%
row_spec(seq(1,length(BIC_vector)), extra_css = "border-bottom: 2px solid;") %>%
column_spec(1:2, extra_css = "border-left: 2px solid;") %>%
add_header_above(cn, extra_css = border_string,
background = alpha("lightblue",0.2))
}
vec <- c(1,2,3)
# See the best number of clusters identified by the BIC
table_BIC(vec)
source("required_packages.R")
# See the best number of clusters identified by the BIC
table_BIC(vec)
